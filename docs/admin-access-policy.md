# Политика доступа к админке

## URL и домены
- Django admin доступен по пути `/control-center/` и должен проксироваться отдельным субдоменом `admin.obsidian.io` (или stage-эквивалентом).
- Путь не должен разглашаться публично, переменная `DJANGO_ADMIN_PATH` позволяет задать индивидуальное значение на окружение.

## Сетевые ограничения
- Разрешённый список IP/подсетей задаётся через `DJANGO_ADMIN_ALLOWED_IPS`.
- Дополнительно поддерживается проверка ASN через заголовок `X-ASN` и список `DJANGO_ADMIN_ALLOWED_ASN`.
- Доступы без доверенных IP/ASN блокируются на уровне middleware, запросы логируются.

## Аутентификация и MFA
- Для ролей `staff`, `moderator`, `finance` двухфакторная аутентификация обязательна. Без включённого TOTP-профиля вход блокируется.
- 2FA включает генерацию секретов и резервных кодов через существующий модуль `accounts.twofactor`.
- Раздача учёток без 2FA запрещена, ответственность несёт руководитель направления.

## Разделение привилегий
- Роль модератора контента не имеет доступа к финансовым разделам; для финансов создаётся отдельная группа `finance`.
- Django-группы `moderator` и `finance` назначаются только после проверки безопасности.
- Любые временные расширения прав фиксируются в журнале доступа и автоматически отзываются после истечения срока.

## Операционные требования
- Все админские действия логируются и регулярно ревьюятся.
- Изменение сетевых whitelist'ов производится через pull-request и подтверждается двумя участниками команды безопасности.
- При компрометации учётной записи её доступ немедленно блокируется, а все активные сессии отзывются.
