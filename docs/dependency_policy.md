# Политика управления зависимостями

## Цели
- Обеспечивать безопасность и актуальность зависимостей backend и frontend.
- Минимизировать риски регрессий при обновлениях.
- Поддерживать прозрачный процесс добавления новых пакетов.

## Аудит уязвимостей
- **Частота:** ежемесячно и дополнительно перед каждым релизом.
- **Ответственные:**
  - Backend — команда платформенной разработки.
  - Frontend — команда клиентского интерфейса.
- **Инструменты и команды:**
  - Python: `pip install --upgrade pip pip-audit safety` (однократно для установки), затем `pip-audit --requirement backend/requirements.txt` и `safety check --file backend/requirements.txt --full-report`.
  - Frontend: `npm audit --production`.
- **Документирование:** результаты аудитов фиксируются в Confluence/Notion и дублируются в описании соответствующих задач.

## Обновление зависимостей
- **Плановое обновление:** ежеквартально создаём задачи на обновление зависимостей до последних совместимых минорных/патч-версий.
- **Внеплановое обновление:** критические уязвимости (CVSS ≥ 7) устраняются незамедлительно.
- **Процесс:**
  1. Создать ветку и задачу в трекере.
  2. Обновить зависимости (Python — через `pip-compile` или ручное обновление pin'ов; frontend — через `npm install package@latest --save(--dev)`).
  3. Выполнить тесты (`pytest`/`python manage.py test`, `npm run test`/`npm run build`) и линтеры.
  4. Создать PR с описанием изменений и ссылками на результаты аудитов/тестов.
- **Ответственные:** за backend — технический лидер backend, за frontend — технический лидер frontend.

## Добавление новых пакетов
- **Обязателен код-ревью:** каждое добавление новой зависимости должно проходить через PR с участием профильного технического лида.
- **Оценка риска:**
  - Проверяем популярность и поддерживаемость пакета (GitHub stars, активность коммитов, наличие релизов за последние 12 месяцев).
  - Ищем известные уязвимости (`pip-audit`, `safety`, `npm audit`, `npm view package@version vulnerabilities`).
  - Анализируем лицензию на совместимость с проектом.
- **Документация:** в описании PR указать назначение пакета, ключевые альтернативы и результаты проверки риска.
- **Запреты:** нельзя добавлять пакеты, требующие смены основного стека (Django/React) без архитектурного ревью.

## Ретроспектива
- Раз в полгода проводим ревизию зависимостей: оцениваем, какие пакеты устарели или не используются, и планируем их удаление или замену.
